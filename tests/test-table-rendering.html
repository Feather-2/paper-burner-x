<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Ë°®Ê†ºÊ∏≤ÊüìÊµãËØï</title>
    <script src="https://cdn.jsdelivr.net/npm/markdown-it@13.0.1/dist/markdown-it.min.js"></script>
    <script src="js/processing/markdown_processor_ast.js"></script>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            max-width: 1400px;
            margin: 20px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-case {
            background: white;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 18px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 8px;
        }
        .source {
            background: #f8f9fa;
            padding: 12px;
            margin: 10px 0;
            border-left: 3px solid #27ae60;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            white-space: pre-wrap;
            word-break: break-all;
        }
        .result {
            background: #fff;
            padding: 15px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .result table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        .result th, .result td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .result th {
            background: #3498db;
            color: white;
        }
        .result tr:nth-child(even) {
            background: #f2f2f2;
        }
        .status {
            display: inline-block;
            padding: 5px 12px;
            margin-left: 10px;
            border-radius: 4px;
            font-size: 13px;
            font-weight: bold;
        }
        .success { background: #27ae60; color: white; }
        .fail { background: #e74c3c; color: white; }
        .html-output {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 12px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 11px;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <h1>üìä Ë°®Ê†ºÊ∏≤ÊüìÊµãËØï</h1>

    <div id="test-container"></div>

    <script>
        // ÊµãËØïÁî®‰æãÔºö‰ªéÁÆÄÂçïÂà∞Â§çÊùÇ
        const testCases = [
            {
                title: 'ÊµãËØï 1: ÁÆÄÂçïË°®Ê†º',
                markdown: `| Âàó1 | Âàó2 |
|-----|-----|
| Êï∞ÊçÆ1 | Êï∞ÊçÆ2 |`
            },
            {
                title: 'ÊµãËØï 2: Â∏¶Êï∞Â≠óÁöÑË°®Ê†º',
                markdown: `| ÂèÇÊï∞ | ÂÄº |
|------|------|
| ÈÄüÂ∫¶ | 0.145*** |
| ÈïøÂ∫¶ | 0.200** |`
            },
            {
                title: 'ÊµãËØï 3: Áî®Êà∑Êèê‰æõÁöÑË°®Ê†ºÔºàÊ≠£Â∏∏Ê†ºÂºèÔºâ',
                markdown: `| | | | ‰∫îÂàÜ‰ΩçÊï∞ (Quintiles) | | | |
|---|---|---|---|---|---|---|
| | 1 | 2 | 3 | 4 | 5 | 5-1 |
| Â∏ÇÂú∫ (Market) | 0.145*** | 0.200** | 0.061* | 0.136* | 0.106*** | -0.039 |
| | (2.774) | (2.441) | (1.938) | (1.689) | (2.703) | (-0.930) |
| ËßÑÊ®° (Size) | 0.107** | 0.329* | 0.147** | 0.206** | 0.059*** | 0.047 |
| | (2.163) | (1.800) | (2.223) | (2.452) | (3.150) | (1.090) |`
            },
            {
                title: 'ÊµãËØï 4: ÂéãÁº©ÁöÑÂçïË°åË°®Ê†ºÔºàÂéüÂßãÈóÆÈ¢òÔºâ‚ö†Ô∏è',
                markdown: `| | | | ‰∫îÂàÜ‰ΩçÊï∞ (Quintiles) | | | |---|---|---|---|---|---|---| | | 1 | 2 | 3 | 4 | 5 | 5-1 | | Â∏ÇÂú∫ (Market) | 0.145*** | 0.200** | 0.061* | 0.136* | 0.106*** | -0.039 | | | (2.774) | (2.441) | (1.938) | (1.689) | (2.703) | (-0.930) | | ËßÑÊ®° (Size) | 0.107** | 0.329* | 0.147** | 0.206** | 0.059*** | 0.047 | | | (2.163) | (1.800) | (2.223) | (2.452) | (3.150) | (1.090) |`,
                isCompressed: true
            },
            {
                title: 'ÊµãËØï 5: ÁÆÄÂåñÁöÑÂéãÁº©Ë°®Ê†º',
                markdown: `| A | B | C ||---|---|---|| 1 | 2 | 3 || 4 | 5 | 6 |`,
                isCompressed: true
            }
        ];

        const container = document.getElementById('test-container');

        testCases.forEach((test, idx) => {
            const testDiv = document.createElement('div');
            testDiv.className = 'test-case';

            // Ê†áÈ¢ò
            const titleDiv = document.createElement('div');
            titleDiv.className = 'test-title';
            titleDiv.textContent = test.title;
            testDiv.appendChild(titleDiv);

            // Ê∫êÁ†Å
            const sourceLabel = document.createElement('div');
            sourceLabel.style.fontWeight = 'bold';
            sourceLabel.style.marginTop = '10px';
            sourceLabel.textContent = 'Markdown Ê∫êÁ†Å:';
            testDiv.appendChild(sourceLabel);

            const sourceDiv = document.createElement('div');
            sourceDiv.className = 'source';
            sourceDiv.textContent = test.markdown;
            testDiv.appendChild(sourceDiv);

            // markdown-it Áõ¥Êé•Ê∏≤Êüì
            const mdLabel = document.createElement('div');
            mdLabel.style.fontWeight = 'bold';
            mdLabel.style.marginTop = '15px';
            mdLabel.textContent = 'markdown-it Áõ¥Êé•Ê∏≤Êüì:';

            try {
                const mdDirect = markdownit({ html: true, breaks: false });
                const htmlDirect = mdDirect.render(test.markdown);

                const hasTable = htmlDirect.includes('<table');
                const status = document.createElement('span');
                status.className = `status ${hasTable ? 'success' : 'fail'}`;
                status.textContent = hasTable ? '‚úì ÁîüÊàê‰∫ÜË°®Ê†º' : '‚úó Êú™ÁîüÊàêË°®Ê†º';
                mdLabel.appendChild(status);

                testDiv.appendChild(mdLabel);

                const mdResult = document.createElement('div');
                mdResult.className = 'result';
                mdResult.innerHTML = htmlDirect;
                testDiv.appendChild(mdResult);

                // ÊòæÁ§∫ HTML Ê∫êÁ†Å
                const htmlSourceLabel = document.createElement('div');
                htmlSourceLabel.style.fontWeight = 'bold';
                htmlSourceLabel.style.marginTop = '10px';
                htmlSourceLabel.textContent = 'ÁîüÊàêÁöÑ HTML:';
                testDiv.appendChild(htmlSourceLabel);

                const htmlOutput = document.createElement('div');
                htmlOutput.className = 'html-output';
                htmlOutput.textContent = htmlDirect;
                testDiv.appendChild(htmlOutput);

            } catch (error) {
                const status = document.createElement('span');
                status.className = 'status fail';
                status.textContent = '‚úó Ê∏≤ÊüìÂá∫Èîô';
                mdLabel.appendChild(status);
                testDiv.appendChild(mdLabel);

                const errorDiv = document.createElement('div');
                errorDiv.style.color = '#e74c3c';
                errorDiv.textContent = `ÈîôËØØ: ${error.message}`;
                testDiv.appendChild(errorDiv);
            }

            // MarkdownProcessorAST Ê∏≤ÊüìÔºàÂ¶ÇÊûúÂèØÁî®Ôºâ
            if (typeof MarkdownProcessorAST !== 'undefined') {
                const astLabel = document.createElement('div');
                astLabel.style.fontWeight = 'bold';
                astLabel.style.marginTop = '15px';
                astLabel.textContent = 'MarkdownProcessorAST Ê∏≤Êüì:';

                try {
                    const htmlAST = MarkdownProcessorAST.render(test.markdown);

                    const hasTable = htmlAST.includes('<table');
                    const status = document.createElement('span');
                    status.className = `status ${hasTable ? 'success' : 'fail'}`;
                    status.textContent = hasTable ? '‚úì ÁîüÊàê‰∫ÜË°®Ê†º' : '‚úó Êú™ÁîüÊàêË°®Ê†º';
                    astLabel.appendChild(status);

                    testDiv.appendChild(astLabel);

                    const astResult = document.createElement('div');
                    astResult.className = 'result';
                    astResult.innerHTML = htmlAST;
                    testDiv.appendChild(astResult);

                    // ÊòæÁ§∫ HTML Ê∫êÁ†Å
                    const htmlSourceLabel = document.createElement('div');
                    htmlSourceLabel.style.fontWeight = 'bold';
                    htmlSourceLabel.style.marginTop = '10px';
                    htmlSourceLabel.textContent = 'ÁîüÊàêÁöÑ HTML:';
                    testDiv.appendChild(htmlSourceLabel);

                    const htmlOutput = document.createElement('div');
                    htmlOutput.className = 'html-output';
                    htmlOutput.textContent = htmlAST;
                    testDiv.appendChild(htmlOutput);

                } catch (error) {
                    const status = document.createElement('span');
                    status.className = 'status fail';
                    status.textContent = '‚úó Ê∏≤ÊüìÂá∫Èîô';
                    astLabel.appendChild(status);
                    testDiv.appendChild(astLabel);

                    const errorDiv = document.createElement('div');
                    errorDiv.style.color = '#e74c3c';
                    errorDiv.textContent = `ÈîôËØØ: ${error.message}`;
                    testDiv.appendChild(errorDiv);
                }
            }

            container.appendChild(testDiv);
        });
    </script>
</body>
</html>
