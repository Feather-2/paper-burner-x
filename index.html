<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Paper Burner X - 您的一站式AI文献阅读与智能分析平台，支持OCR、翻译、深度解析与高级管理。">
    <title>Paper Burner X - AI文献阅读与智能分析平台</title>
    <!-- Tailwind CSS & 依赖库 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://gcore.jsdelivr.net/npm/iconify-icon@2.0.0/dist/iconify-icon.min.js"></script>
    <script src="https://gcore.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://gcore.jsdelivr.net/npm/js-base64@3.7.5/base64.min.js"></script>
    <script src="https://gcore.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
    <script src="https://gcore.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
    <link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <link rel="stylesheet" href="css/markdown-enhanced.css">
    <link rel="stylesheet" href="css/math-display-fix.css">
    <script src="https://gcore.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://gcore.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
      // failback: 如果 CDN 加载失败，自动加载本地 jszip
      if (typeof JSZip === 'undefined') {
        var script = document.createElement('script');
        script.src = 'js/lib/jszip.min.js';
        document.head.appendChild(script);
      }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <style>
        /* 谷歌字体 Nunito */
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;500;600;700&display=swap');
        /* 基础字体设置 */
        body {
            font-family: 'Nunito', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }
        /* 背景渐变 */
        .gradient-bg {
            /* background: linear-gradient(135deg, #f5f7fa 0%, #e4edf9 100%); */
            background-color: #F3F6FA; /* 主题背景色 */
        }
        /* 卡片渐变 */
        .gradient-card {
            background: linear-gradient(135deg, #ffffff 0%, #f9fbff 100%);
        }
        /* 通用过渡效果 */
        .transition-all {
            transition: all 0.3s ease;
        }
        /* 文件列表项样式 */
        .file-list-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem;
            background-color: #f8f9fa;
            margin-bottom: 0.5rem;
            border: 1px solid #e9ecef;
        }
        .file-list-item:last-child {
            margin-bottom: 0;
        }
        /* API Key 输入框样式 */
        textarea.api-key-input {
            min-height: 60px; /* 最小高度 */
            resize: vertical; /* 允许垂直方向调整大小 */
        }
        /* 闪烁提示动画基类 */
        .flash-tip-anim {
            opacity: 0;
            transition: opacity 0.5s;
            will-change: opacity;
        }
        /* 闪烁提示显示状态 */
        .flash-tip-anim.show {
            opacity: 1;
        }
        /* 闪烁提示隐藏状态 */
        .flash-tip-anim.hide {
            opacity: 0;
        }
        /* Skeleton Character Rows */
        .skeleton-bg .skeleton-row {
            border-radius: 8px;
            background: linear-gradient(90deg, #e5e7eb 25%, #f3f6fa 50%, #e5e7eb 75%);
            background-size: 200% 100%;
            animation: shimmer 1.8s infinite linear;
        }
        .skeleton-fake-text {
            color: #d1d5db;
            font-size: 1rem;
            font-family: 'Fira Mono', 'Consolas', monospace;
            font-weight: bold;
            opacity: 0.5;
            letter-spacing: 0.1em;
            animation: shimmer 1.8s infinite linear;
            user-select: none;
        }
        .skeleton-fake-text.text-lg {
            font-size: 1.25rem;
        }

        /* New Top-Blue to Bottom-White Gradient for Landing Page Background */
        .ocean-gradient-bg {
          background: linear-gradient(to bottom, #93C5FD 0%, #FFFFFF 100%); /* Tailwind blue-300 to white */
        }

        /* ===== 版权声明弹窗美化与动画 ===== */
        #copyrightModal {
          backdrop-filter: blur(6px) saturate(120%);
          background: rgba(30, 41, 59, 0.35) !important; /* 深色毛玻璃 */
          animation: copyrightModalFadeIn 0.4s cubic-bezier(.4,2,.6,1) both;
        }
        @keyframes copyrightModalFadeIn {
          0% { opacity: 0; }
          100% { opacity: 1; }
        }
        .copyright-card-ani {
          background: linear-gradient(135deg, #f8fafc 60%, #e0e7ef 100%);
          box-shadow: 0 8px 32px 0 rgba(31, 41, 55, 0.18), 0 1.5px 6px 0 rgba(59,130,246,0.08);
          border-radius: 1.5rem;
          border: 1.5px solid #e0e7ef;
          animation: copyrightCardPopIn 0.5s cubic-bezier(.4,2,.6,1) both;
          max-width: 900px;
          transform: scale(0.9);
          transform-origin: top center;
        }
        @keyframes copyrightCardPopIn {
          0% { transform: scale(0.92) translateY(40px); opacity: 0; }
          100% { transform: scale(1) translateY(0); opacity: 1; }
        }
        .copyright-card-ani h2 {
          letter-spacing: 0.02em;
          background: linear-gradient(90deg, #2563eb 30%, #60a5fa 100%);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
        }
        .copyright-card-ani .main-btn {
          background: linear-gradient(90deg, #2563eb 60%, #38bdf8 100%);
          color: #fff;
          font-weight: 600;
          box-shadow: 0 2px 8px 0 rgba(59,130,246,0.10);
          border-radius: 0.75rem;
          transition: background 0.2s, box-shadow 0.2s;
        }
        .copyright-card-ani .main-btn:hover {
          background: linear-gradient(90deg, #1d4ed8 60%, #0ea5e9 100%);
          box-shadow: 0 4px 16px 0 rgba(59,130,246,0.18);
        }
        .copyright-card-ani .iconify-icon {
          vertical-align: middle;
        }
        .feature-card-modern {
          position: relative;
          overflow: hidden;
          border-radius: 20px;
          padding: clamp(16px, 2vw, 20px);
          background: linear-gradient(130deg, rgba(87,130,243,0.08), rgba(255,255,255,0.98));
          border: 1px solid rgba(87,130,243,0.14);
          box-shadow: 0 12px 28px rgba(70,96,168,0.12);
          transition: transform 0.25s ease, box-shadow 0.25s ease;
        }
        .feature-card-modern::before {
          content: '';
          position: absolute;
          inset: 0;
          background: linear-gradient(135deg, rgba(255,255,255,0.32), rgba(87,130,243,0.18));
          opacity: 0;
          transition: opacity 0.3s ease;
        }
        .feature-card-modern:hover {
          transform: translateY(-4px);
          box-shadow: 0 18px 36px rgba(70,96,168,0.16);
        }
        .feature-card-modern:hover::before {
          opacity: 1;
        }
        .feature-card-modern > * {
          position: relative;
          z-index: 1;
        }
        .feature-icon-ring {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          width: 42px;
          height: 42px;
          border-radius: 14px;
          background: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(87,130,243,0.16));
          box-shadow: inset 0 1px 0 rgba(255,255,255,0.5);
        }
        .feature-meta {
          display: flex;
          flex-wrap: wrap;
          gap: 0.3rem;
          margin-top: 0.6rem;
        }
        .feature-meta span {
          display: inline-flex;
          align-items: center;
          padding: 0.28rem 0.65rem;
          border-radius: 999px;
          font-size: 0.75rem;
          font-weight: 600;
          letter-spacing: 0.01em;
          backdrop-filter: blur(8px);
        }
        .feature-card-inner {
          display: flex;
          align-items: flex-start;
          gap: 14px;
        }
        .feature-card-inner h4 {
          margin-bottom: 0.35rem;
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <script>
        // Redirect to landing page if it hasn't been shown yet
        if (!localStorage.getItem('paperBurnerLandingPageShown')) {
            // Check if the current page is not landing-page.html to prevent redirect loop
            // and also ensure we are in the root or a similar path if index.html is not at root.
            var currentPath = window.location.pathname;
            if (currentPath.indexOf('landing-page.html') === -1) {
                var basePath = currentPath.substring(0, currentPath.lastIndexOf('/') + 1);
                // Ensure that if index.html is in a subfolder, landing-page.html is sought in the same folder.
                // If index.html is at root, basePath will be "/", and landing-page.html will be /landing-page.html.
                window.location.href = basePath + 'views/landing/landing-page.html';
            }
        }
    </script>

    <div id="mainAppContainer" class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- ===================== -->
        <!-- 顶部标题与简介 -->
        <!-- ===================== -->
        <header class="text-center mt-8 mb-12">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-3">Paper Burner X: <span class="text-blue-600">AI 辅助</span> 的文献阅读与分析工具</h1>
            <p class="text-gray-600 max-w-2xl mx-auto">提供多种格式的文本提取、翻译、内容分析及管理功能，旨在提升文献处理效率。</p>
        </header>

        <main>
            <!-- ===================== -->
            <!-- 新增的步骤标题 -->
            <!-- ===================== -->
            <div class="mb-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                    <iconify-icon icon="carbon:document-preliminary" class="mr-2 text-blue-500" width="24"></iconify-icon>
                    Step 1：文档识别
                </h2>
            </div>

            <!-- ===================== -->
            <!-- 主功能卡片区域 -->
            <!-- ===================== -->
            <div class="bg-white rounded-xl shadow-sm p-6 mb-3">

                <!-- API 密钥设置 (旧版，已注释掉) -->
                <!--
                <div class="mb-6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                        <iconify-icon icon="carbon:api" class="mr-2 text-blue-500" width="24"></iconify-icon>
                        API 密钥设置
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="mistralApiKeys" class="block text-sm font-medium text-gray-700 mb-1">Mistral API Keys <span class="text-red-500">*</span> (每行一个)</label>
                            <div class="relative">
                                <textarea id="mistralApiKeys" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all api-key-input" placeholder="输入您的 Mistral API Key(s)，每行一个"></textarea>
                            </div>
                        </div>
                        <div>
                            <label for="translationApiKeys" class="block text-sm font-medium text-gray-700 mb-1">翻译 API Keys (可选, 每行一个)</label>
                            <div class="relative">
                                <textarea id="translationApiKeys" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all api-key-input" placeholder="输入翻译服务 API Key(s)，每行一个 (可选)"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                -->

                <!-- ===================== -->
                <!-- 翻译设置 -->
                <!-- ===================== -->
                <div class="mb-6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4 flex justify-between items-center">
                        <span class="flex items-center">
                            <iconify-icon icon="carbon:translate" class="mr-2 text-blue-500" width="24"></iconify-icon>
                            翻译设置
                        </span>
                        <span class="flex items-center">
                            <span id="flashConfigTip" class="flash-tip-anim text-base text-blue-600 font-semibold mr-1">配置模型与Key管理</span>
                            <iconify-icon id="modelKeyManagerBtn" icon="carbon:settings" width="22" class="text-gray-400 hover:text-blue-600 cursor-pointer transition-colors" title="模型与Key管理"></iconify-icon>
                        </span>
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- 翻译模型选择 -->
                        <div>
                            <label for="translationModel" class="block text-sm font-medium text-gray-700 mb-1">翻译模型</label>
                            <select id="translationModel" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all">
                                <option value="none">不需要翻译</option>
                                <option value="mistral">Mistral Large</option>
                                <option value="deepseek">deepseek</option>
                                <option value="gemini">gemini</option>
                                <option value="deeplx">DeepLX (DeepL 接口)</option>
                                <option value="tongyi">通义百炼</option>
                                <option value="volcano">火山引擎</option>
                                <option value="custom">自定义模型</option>
                            </select>
                            <div id="translationModelDefaultHint" class="text-xs text-gray-500 mt-1"></div>
                        </div>
                        <!-- 目标语言选择 -->
                        <div>
                            <label for="targetLanguage" class="block text-sm font-medium text-gray-700 mb-1">目标语言</label>
                            <select id="targetLanguage" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all">
                                <option value="chinese">中文</option>
                                <option value="english">English</option>
                                <option value="japanese">日本語</option>
                                <option value="korean">한국어</option>
                                <option value="french">Français</option>
                                <option value="custom">自定义</option>
                            </select>
                            <!-- 自定义目标语言名称输入区域 -->
                            <div id="customTargetLanguageContainer" class="hidden mt-2">
                                 <label for="customTargetLanguageInput" class="block text-sm font-medium text-gray-700 mb-1">自定义目标语言名称</label>
                                 <input type="text" id="customTargetLanguageInput" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" placeholder="例如: Spanish">
                            </div>
                        </div>
                        <!-- Gemini 模型信息（选择 Gemini 时显示） -->
                        <div id="geminiModelInfo" class="md:col-span-2 hidden">
                            <div class="mt-2 border border-gray-200 rounded-lg bg-gray-50 p-3">
                                <div class="flex items-center justify-between">
                                    <div class="text-sm text-gray-700 font-medium">Gemini 默认模型</div>
                                    <div class="flex items-center gap-2">
                                        <span id="geminiKeysCountHint" class="text-xs text-gray-500"></span>
                                        <button id="geminiDetectBtn" type="button" class="px-2 py-1 text-xs border rounded hover:bg-white">检测可用模型</button>
                                    </div>
                                </div>
                                <div class="mt-2 space-y-2">
                                    <div class="flex flex-col sm:flex-row sm:items-center sm:gap-2">
                                        <select id="geminiModelSelect" class="flex-1 px-3 py-1.5 border border-gray-300 rounded-md text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 transition-colors">
                                           <!-- 动态填充，可为空则仅显示占位提示 -->
                                        </select>
                                        <button id="geminiModelSearchBtn" type="button" class="mt-2 sm:mt-0 px-3 py-1.5 text-sm border border-gray-300 rounded-md text-gray-600 hover:text-blue-600 hover:border-blue-400 transition-colors flex items-center gap-1 disabled:opacity-60 disabled:cursor-not-allowed">
                                            <iconify-icon icon="carbon:search" width="16"></iconify-icon>
                                            搜索模型
                                        </button>
                                    </div>
                                    <p id="geminiModelHint" class="text-xs text-gray-500">若列表为空，请先点击上方“检测可用模型”。</p>
                                </div>

                            </div>
                        </div>
                        <!-- DeepLX 模型信息（选择 DeepLX 时显示） -->
                        <div id="deeplxModelInfo" class="md:col-span-2 hidden">
                            <div class="mt-2 border border-gray-200 rounded-lg bg-gray-50 p-3">
                                <div class="flex items-center justify-between">
                                    <div class="text-sm text-gray-700 font-medium">DeepLX 接口设置</div>
                                    <span id="deeplxKeysCountHint" class="text-xs text-gray-500"></span>
                                </div>
                                <div class="mt-2 space-y-2">
                                    <label for="deeplxEndpointTemplateInput" class="text-xs text-gray-500 block">接口模板（使用 &lt;api-key&gt; 或 {API_KEY} 占位符）</label>
                                    <div class="flex items-center gap-2">
                                        <input id="deeplxEndpointTemplateInput" type="text" class="flex-1 px-3 py-1.5 border border-gray-300 rounded-md text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 transition-colors" placeholder="https://api.deeplx.org/&lt;api-key&gt;/translate">
                                        <button id="deeplxEndpointResetBtn" type="button" class="px-2 py-1 text-xs border rounded hover:bg-white">恢复默认</button>
                                    </div>
                                    <p class="text-xs text-gray-500 leading-5">默认模板会在占位符位置插入当前使用的 API Key，例如 <code>https://api.deeplx.org/&lt;api-key&gt;/translate</code>。如需自建代理，可在此输入自定义地址。</p>
                                    <p id="deeplxTargetLangHint" class="text-xs text-blue-700 leading-5"></p>
                                    <div id="deeplxLangTable" class="mt-2 text-xs text-gray-600 leading-5"></div>
                                </div>
                            </div>
                        </div>

                        <!-- DeepSeek 模型信息（选择 DeepSeek 时显示） -->
                        <div id="deepseekModelInfo" class="md:col-span-2 hidden">
                            <div class="mt-2 border border-gray-200 rounded-lg bg-gray-50 p-3">
                                <div class="flex items-center justify-between">
                                    <div class="text-sm text-gray-700 font-medium">DeepSeek 默认模型</div>
                                    <div class="flex items-center gap-2">
                                        <span id="deepseekKeysCountHint" class="text-xs text-gray-500"></span>
                                        <button id="deepseekDetectBtn" type="button" class="px-2 py-1 text-xs border rounded hover:bg-white">检测可用模型</button>
                                    </div>
                                </div>
                                <div class="mt-2 space-y-2">
                                    <div class="flex flex-col sm:flex-row sm:items-center sm:gap-2">
                                        <select id="deepseekModelSelect" class="flex-1 px-3 py-1.5 border border-gray-300 rounded-md text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 transition-colors"></select>
                                        <button id="deepseekModelSearchBtn" type="button" class="mt-2 sm:mt-0 px-3 py-1.5 text-sm border border-gray-300 rounded-md text-gray-600 hover:text-blue-600 hover:border-blue-400 transition-colors flex items-center gap-1 disabled:opacity-60 disabled:cursor-not-allowed">
                                            <iconify-icon icon="carbon:search" width="16"></iconify-icon>
                                            搜索模型
                                        </button>
                                    </div>
                                    <p id="deepseekModelHint" class="text-xs text-gray-500">若列表为空，请先点击上方“检测可用模型”。</p>
                                </div>
                            </div>

                        </div>

                        <!-- 通义 模型信息（选择通义时显示） -->
                        <div id="tongyiModelInfo" class="md:col-span-2 hidden">
                            <div class="mt-2 border border-gray-200 rounded-lg bg-gray-50 p-3">
                                <div class="flex items-center justify-between">
                                    <div class="text-sm text-gray-700 font-medium">通义 默认模型</div>
                                    <div class="flex items-center gap-2">
                                        <span id="tongyiKeysCountHint" class="text-xs text-gray-500"></span>
                                        <button id="tongyiDetectBtn" type="button" class="px-2 py-1 text-xs border rounded hover:bg-white">检测可用模型</button>
                                    </div>
                                </div>
                                <div class="mt-2 space-y-2">
                                    <div class="flex flex-col sm:flex-row sm:items-center sm:gap-2">
                                        <select id="tongyiModelSelect" class="flex-1 px-3 py-1.5 border border-gray-300 rounded-md text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 transition-colors"></select>
                                        <button id="tongyiModelSearchBtn" type="button" class="mt-2 sm:mt-0 px-3 py-1.5 text-sm border border-gray-300 rounded-md text-gray-600 hover:text-blue-600 hover:border-blue-400 transition-colors flex items-center gap-1 disabled:opacity-60 disabled:cursor-not-allowed">
                                            <iconify-icon icon="carbon:search" width="16"></iconify-icon>
                                            搜索模型
                                        </button>
                                    </div>
                                    <p id="tongyiModelHint" class="text-xs text-gray-500">若列表为空，请先点击上方“检测可用模型”。</p>
                                </div>
                            </div>
                        </div>

                        <!-- 火山 模型信息（选择火山时显示） -->
                        <div id="volcanoModelInfo" class="md:col-span-2 hidden">
                            <div class="mt-2 border border-gray-200 rounded-lg bg-gray-50 p-3">
                                <div class="flex items-center justify-between">
                                    <div class="text-sm text-gray-700 font-medium">火山 默认模型</div>
                                    <div class="flex items-center gap-2">
                                        <span id="volcanoKeysCountHint" class="text-xs text-gray-500"></span>
                                        <button id="volcanoDetectBtn" type="button" class="px-2 py-1 text-xs border rounded hover:bg-white">检测可用模型</button>
                                    </div>
                                </div>
                                <div class="mt-2">
                                    <select id="volcanoModelSelect" class="w-full px-3 py-1.5 border border-gray-300 rounded-md text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 transition-colors"></select>
                                    <p id="volcanoModelHint" class="mt-1 text-xs text-gray-500">若列表为空，请手动输入或在设置中选择。</p>
                                </div>
                            </div>
                        </div>
                        <!-- 自定义源站点设置区域 (选择自定义模型时显示) -->
                        <div id="customSourceSiteContainer" class="md:col-span-2 hidden">
                            <div class="pt-4">
                                <!-- 展开/收起自定义源站点设置的按钮 -->
                                <button id="customSourceSiteToggle" type="button" class="text-sm text-gray-500 hover:text-gray-700 flex items-center">
                                    <iconify-icon icon="carbon:settings-adjust" class="mr-1" width="16"></iconify-icon>
                                    <span>自定义源站点设置</span>
                                    <iconify-icon id="customSourceSiteToggleIcon" icon="carbon:chevron-down" class="ml-1" width="16"></iconify-icon>
                                </button>
                                <!-- 自定义源站点详细配置区 -->
                                <div id="customSourceSite" class="hidden mt-2 border-2 border-dashed border-gray-300 rounded-lg p-4">
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <!-- 选择已保存的自定义源站点 -->
                                        <div>
                                            <label for="customSourceSiteSelect" class="block text-sm font-medium text-gray-700 mb-1">选择自定义源站点</label>
                                            <select id="customSourceSiteSelect" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all">
                                                <!-- Options will be populated by JavaScript -->
                                            </select>
                                        </div>
                                        <!-- 显示选定源站点的基本信息 -->
                                        <div id="customSourceSiteInfo" class="mt-3 w-full border border-gray-200 rounded-lg bg-gray-50 p-0 hidden md:col-span-2">
                                            <!-- 站点信息将由JS动态填充 -->
                                        </div>
                                        <!-- 管理API Key及检测模型的按钮（通常根据选择的源站点动态显示/隐藏） -->
                                        <div class="mt-2 flex justify-end w-full md:col-span-2">
                                            <button id="manageSourceSiteKeyBtn" class="px-3 py-1.5 text-sm bg-blue-500 hover:bg-blue-600 text-white rounded transition-colors flex items-center hidden">
                                                <iconify-icon icon="carbon:api" class="mr-1" width="16"></iconify-icon>
                                                管理该站点 API Key
                                            </button>
                                            <button id="detectModelsBtn" type="button" class="hidden px-3 py-1.5 text-sm bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors flex items-center">
                                                <iconify-icon icon="carbon:model-alt" class="mr-1" width="16"></iconify-icon>
                                                检测可用模型
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ===== 翻译备择库管理（多术语库） ===== -->
                        <div id="glossaryManagerSection" class="md:col-span-2 hidden">
                            <div class="bg-white/90 backdrop-blur-sm border-2 border-dashed border-blue-200 rounded-2xl shadow-sm p-5 md:p-6 space-y-5">
                                <div class="flex flex-col md:flex-row md:items-start md:justify-between gap-4">
                                    <div>
                                        <div class="flex items-center gap-2 text-lg font-semibold text-slate-800">
                                            <iconify-icon icon="carbon:dictionary" class="text-blue-500" width="22"></iconify-icon>
                                            <span>翻译备择库管理</span>
                                            <span id="glossarySetsCountHint" class="ml-1 inline-flex items-center text-xs font-medium text-blue-600 bg-blue-50 border border-blue-100 rounded-full px-2 py-0.5">启用 0 / 0</span>
                                        </div>
                                        <p class="mt-2 text-sm text-slate-500 leading-relaxed">
                                            支持维护多套术语库，命中时自动注入翻译提示，帮助保持术语一致性。可按项目导入导出，灵活协同。
                                        </p>
                                    </div>
                                    <label class="inline-flex items-center gap-2 bg-slate-50 border border-slate-200 rounded-full px-4 py-2 text-sm text-slate-600 select-none">
                                        <input id="enableGlossaryToggle" type="checkbox" class="h-4 w-4 text-blue-600 border-slate-300 rounded">
                                        <span>启用翻译备择库</span>
                                    </label>
                                </div>

                                <div class="flex flex-wrap items-center gap-2 md:gap-3">
                                    <button id="addGlossarySetBtn" class="inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-slate-700 bg-white border border-slate-200 rounded-lg hover:border-blue-300 hover:text-blue-600 hover:shadow-sm transition-all">
                                        <iconify-icon icon="carbon:add-alt" width="18"></iconify-icon>新增术语库
                                    </button>
                                    <button id="importGlossarySetBtn" class="inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-slate-700 bg-white border border-slate-200 rounded-lg hover:border-blue-300 hover:text-blue-600 hover:shadow-sm transition-all">
                                        <iconify-icon icon="carbon:import" width="18"></iconify-icon>导入术语库
                                    </button>
                                    <input id="importGlossarySetFile" type="file" accept="application/json" class="hidden">
                                    <button id="exportAllGlossarySetsBtn" class="inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-slate-700 bg-white border border-slate-200 rounded-lg hover:border-blue-300 hover:text-blue-600 hover:shadow-sm transition-all">
                                        <iconify-icon icon="carbon:export" width="18"></iconify-icon>导出全部术语库
                                    </button>
                                </div>

                                <div id="glossarySetsTable" class="space-y-3"></div>

                                <!-- 编辑面板 -->
                                <div id="glossaryEditorPanel" class="hidden border border-slate-200 rounded-xl bg-slate-50/70 p-4 md:p-5" data-editing-id="">
                                  <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center gap-2 text-sm font-semibold text-slate-700">
                                      <iconify-icon icon="carbon:list" width="18"></iconify-icon>
                                      <span>术语条目</span>
                                    </div>
                                    <span class="text-xs text-slate-500">点击单元可直接编辑，支持导入导出 JSON</span>
                                  </div>
                                  <div id="glossaryEntriesTable"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <hr class="my-6 border-gray-200">

                <!-- ===================== -->
                <!-- 高级设置区域 -->
                <!-- ===================== -->
                <div class="mt-4 mb-6">
                    <!-- 展开/收起高级设置的按钮 -->
                    <button id="advancedSettingsToggle" class="text-sm text-gray-500 hover:text-gray-700 flex items-center" type="button">
                        <iconify-icon icon="carbon:settings-adjust" class="mr-1" width="16"></iconify-icon>
                        <span>高级设置</span>
                        <iconify-icon icon="carbon:chevron-down" class="ml-1" width="16" id="advancedSettingsIcon"></iconify-icon>
                    </button>

                    <!-- 高级设置详细内容区 -->
                    <div id="advancedSettings" class="hidden mt-2">
                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4 border-b pb-2 flex items-center"><iconify-icon icon="carbon:settings-check" class="mr-2 text-gray-600"></iconify-icon>性能与流程设置</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <!-- 文件处理并发数 -->
                                <div>
                                    <label for="concurrencyLevel" class="block text-sm font-medium text-gray-700 mb-1">文件处理并发数</label>
                                    <input type="number" id="concurrencyLevel" min="1" max="50" value="1"
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500 transition-all text-sm">
                                    <p class="text-xs text-gray-500 mt-1">同时处理的文件数量。默认 1。</p>
                                </div>
                                <!-- 翻译任务并发数 -->
                                <div>
                                    <label for="translationConcurrencyLevel" class="block text-sm font-medium text-gray-700 mb-1">翻译任务并发数</label>
                                    <input type="number" id="translationConcurrencyLevel" min="1" max="150" value="15"
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500 transition-all text-sm">
                                    <p class="text-xs text-gray-500 mt-1">同时进行的翻译 API 调用数量。默认 15。</p>
                                </div>
                                <!-- 翻译分段最大Token数 -->
                                <div class="md:col-span-2">
                                    <label for="maxTokensPerChunk" class="block text-sm font-medium text-gray-700 mb-1">翻译分段最大Token数 (<span id="maxTokensPerChunkValue">2000</span>)</label>
                                    <input type="range" id="maxTokensPerChunk" min="500" max="10000" step="100" value="1000"
                                           class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600">
                                    <p class="text-xs text-gray-500 mt-1">长文档翻译时，按此限制分段。默认 2000。</p>
                                </div>
                                <!-- 跳过已处理文件选项 -->
                                <div class="md:col-span-2 flex items-center mt-2">
                                    <input type="checkbox" id="skipProcessedFiles" class="rounded text-blue-500 focus:ring-blue-500 h-4 w-4 mr-2 flex-shrink-0">
                                    <label for="skipProcessedFiles" class="text-sm text-gray-600">跳过已处理过的文件 (基于文件名和大小)</label>
                                </div>
                            </div>

                            <h3 class="text-lg font-semibold text-gray-800 mb-4 border-b pb-2 flex items-center"><iconify-icon icon="carbon:edit" class="mr-2 text-gray-600"></iconify-icon>翻译提示词管理</h3>

                            <!-- 提示词模式选择（单选，三选一） -->
                            <div class="mb-4">
                                <div class="flex items-center space-x-6 mb-3">
                                    <label class="flex items-center">
                                        <input type="radio" name="promptMode" value="pool" id="promptModePool" class="rounded text-blue-500 focus:ring-blue-500 h-4 w-4 mr-2">
                                        <span class="text-sm font-medium text-gray-700">提示词池</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="promptMode" value="builtin" id="promptModeBuiltin" class="rounded text-blue-500 focus:ring-blue-500 h-4 w-4 mr-2" checked>
                                        <span class="text-sm font-medium text-gray-700">内置提示词</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="promptMode" value="custom" id="promptModeCustom" class="rounded text-blue-500 focus:ring-blue-500 h-4 w-4 mr-2">
                                        <span class="text-sm font-medium text-gray-700">单个自定义</span>
                                    </label>
                                </div>
                                <p class="text-xs text-gray-500">选择翻译提示词的使用方式。提示词池提供多样表达且保持风格一致。</p>
                            </div>

                            <!-- 单个自定义提示区域 -->
                            <div id="customPromptsContainer" class="hidden space-y-4 mb-6">
                                <div>
                                    <label for="defaultSystemPrompt" class="block text-sm font-medium text-gray-700 mb-1">自定义系统提示</label>
                                    <textarea id="defaultSystemPrompt" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500 transition-all api-key-input text-sm" placeholder="输入系统提示词..."></textarea>
                                </div>
                                <div>
                                    <label for="defaultUserPromptTemplate" class="block text-sm font-medium text-gray-700 mb-1">自定义用户提示模板</label>
                                    <textarea id="defaultUserPromptTemplate" rows="6" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500 transition-all api-key-input text-sm" placeholder="请将以下内容翻译为${targetLangName}：&#10;&#10;${content}"></textarea>
                                    <p class="text-xs text-gray-500 mt-1">可用占位符：<code>${targetLangName}</code>, <code>${content}</code></p>
                                </div>
                            </div>

                            <!-- 提示词池管理区域 -->
                            <div id="promptPoolContainer" class="hidden">

                                <!-- 参考提示词输入（去除橙色，改为中性） -->
                                <div id="ppRefSection" class="bg-gray-50 rounded-lg p-4 mb-4 border border-gray-200">
                                    <h4 class="font-medium text-gray-800 mb-3 flex items-center">
                                        <iconify-icon icon="carbon:template" class="text-blue-600 mr-2" width="18"></iconify-icon>
                                        参考提示词 (AI生成基础)
                                    </h4>
                                    <div class="space-y-3">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">参考系统提示词</label>
                                            <textarea id="referenceSystemPrompt" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 text-sm" placeholder="你是专业的翻译助手，请准确翻译用户提供的内容。"></textarea>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">参考用户提示模板</label>
                                            <textarea id="referenceUserPrompt" rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 text-sm" placeholder="请将以下内容翻译为${targetLangName}：&#10;&#10;${content}"></textarea>
                                            <p class="text-xs text-gray-500 mt-1">必须包含 <code>${targetLangName}</code> 和 <code>${content}</code> 占位符</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- 提示词池控制面板 -->
                                <div class="bg-blue-50 rounded-lg p-4 mb-4">
                                    <div id="ppControlHeader" class="flex justify-between items-center mb-3">
                                        <div class="flex items-center">
                                            <iconify-icon icon="carbon:ai-status-running" class="text-blue-600 mr-2" width="20"></iconify-icon>
                                            <span class="font-medium text-blue-800">AI生成提示词池</span>
                                            <span id="poolStatsText" class="ml-2 text-sm text-blue-600">(0 个已选)</span>
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <select id="promptPoolMode" class="text-sm border border-blue-200 rounded px-2 py-1 bg-white">
                                                <option value="random">智能随机</option>
                                                <option value="rotation">健康轮换</option>
                                            </select>
                                        <button id="toggleGeneratorPromptsBtn" class="text-xs px-2 py-1 border rounded hover:bg-gray-50">生成器提示词</button>
                                        <button id="resetGeneratorPromptsBtn" class="text-xs px-2 py-1 border rounded hover:bg-gray-50">重置为默认</button>
                                        </div>
                                    </div>

                                    <!-- 健康状态概览 -->
                                    <div id="healthOverview" class="bg-white rounded-md p-3 mb-3 border border-blue-200">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-sm font-medium text-gray-700">健康状态概览</span>
                                            <button id="healthSettingsBtn" class="text-xs text-blue-600 hover:text-blue-800">
                                                <iconify-icon icon="carbon:settings" width="14"></iconify-icon> 设置
                                            </button>
                                        </div>
                                        <div class="grid grid-cols-4 gap-3 text-center">
                                            <div class="text-xs">
                                                <div class="text-green-600 font-medium" id="healthyCount">0</div>
                                                <div class="text-gray-500">健康</div>
                                            </div>
                                            <div class="text-xs">
                                                <div class="text-yellow-600 font-medium" id="degradedCount">0</div>
                                                <div class="text-gray-500">降级</div>
                                            </div>
                                            <div class="text-xs">
                                                <div class="text-red-600 font-medium" id="deactivatedCount">0</div>
                                                <div class="text-gray-500">失活</div>
                                            </div>
                                            <div class="text-xs">
                                                <div class="text-blue-600 font-medium" id="successRate">0%</div>
                                                <div class="text-gray-500">成功率</div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 生成器元提示词（可选） -->
                                    <div id="generatorPromptsPanel" class="hidden mb-3">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                            <div>
                                                <label class="block text-xs text-gray-600 mb-1">生成器系统提示（可选）</label>
                                                <textarea id="generatorSystemPrompt" rows="3" class="w-full text-sm border border-gray-300 rounded px-2 py-1" placeholder="自定义用于生成变体的系统提示（不填用默认）"></textarea>
                                            </div>
                                            <div>
                                                <label class="block text-xs text-gray-600 mb-1">生成器用户提示（可选）</label>
                                                <textarea id="generatorUserPrompt" rows="3" class="w-full text-sm border border-gray-300 rounded px-2 py-1" placeholder="自定义用于生成变体的用户提示（不填用默认）"></textarea>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 生成参数控制 -->
                                    <div id="ppGenSection">
                                    <!-- 生成参数控制 -->
                                    <div class="grid grid-cols-1 md:grid-cols-5 gap-3 mb-3">
                                        <div>
                                            <label class="block text-xs text-gray-600 mb-1">生成数量</label>
                                            <input type="number" id="variationCount" value="10" min="5" max="20" class="w-full text-sm border border-gray-300 rounded px-2 py-1">
                                        </div>
                                        <div>
                                            <label class="block text-xs text-gray-600 mb-1">并发数</label>
                                            <input type="number" id="generationConcurrency" value="1" min="1" max="10" class="w-full text-sm border border-gray-300 rounded px-2 py-1">
                                            <p class="text-xs text-gray-500 mt-1">最多 10；总生成量 = 生成数量 × 并发数</p>
                                        </div>
                                        <div>
                                            <label class="block text-xs text-gray-600 mb-1">生成语言</label>
                                            <input type="text" id="generatorLanguage" value="中文" placeholder="如：中文、English、日本語" class="w-full text-sm border border-gray-300 rounded px-2 py-1">
                                            <p class="text-xs text-gray-500 mt-1">用于替换生成器提示词中的 ${genlanguage}</p>
                                        </div>
                                        <div>
                                            <label class="block text-xs text-gray-600 mb-1">相似度</label>
                                            <select id="similarityControl" class="w-full text-sm border border-gray-300 rounded px-2 py-1">
                                                <option value="0.2">差异很大</option>
                                                <option value="0.4">中等差异</option>
                                                <option value="0.6" selected>适度相似</option>
                                                <option value="0.8">高度相似</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-xs text-gray-600 mb-1">AI模型</label>
                                            <select id="generationModel" class="w-full text-sm border border-gray-300 rounded px-2 py-1">
                                                <option value="">加载中...</option>
                                            </select>
                                            <p class="text-xs text-gray-500 mt-1">自动使用已配置的API密钥</p>
                                        </div>
                                    </div>

                                    <!-- 生成控制按钮 -->
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center space-x-3">
                                            <button id="generateVariationsBtn" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-sm flex items-center disabled:opacity-50 disabled:cursor-not-allowed">
                                                <iconify-icon icon="carbon:ai-status" class="mr-2" width="16"></iconify-icon>
                                                AI生成变体
                                            </button>
                                            <div id="generateStatus" class="text-xs text-gray-600 hidden">
                                                <iconify-icon icon="carbon:loading" class="animate-spin mr-1" width="14"></iconify-icon>
                                                正在生成...
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <button id="clearPoolBtn" class="px-3 py-1.5 bg-gray-400 text-white rounded text-xs hover:bg-gray-500 transition-colors">
                                                清空
                                            </button>
                                            <button id="importPoolBtn" class="px-3 py-1.5 bg-green-600 text-white rounded text-xs hover:bg-green-700 transition-colors">
                                                导入
                                            </button>
                                            <button id="exportPoolBtn" class="px-3 py-1.5 bg-green-600 text-white rounded text-xs hover:bg-green-700 transition-colors">
                                                导出
                                            </button>
                                        </div>
                                    </div>
                                    </div> <!-- /#ppGenSection -->
                                </div>

                                <!-- 提示词列表容器 -->
                                <div id="promptPoolList" class="space-y-2 max-h-96 overflow-y-auto border border-gray-200 rounded-lg p-3 bg-gray-50">
                                    <div class="text-center text-gray-500 text-sm py-8">
                                        <iconify-icon icon="carbon:ai-status-queued" class="text-gray-400 mb-2" width="32"></iconify-icon>
                                        <p>暂无提示词</p>
                                        <p class="text-xs mt-1">请先填写参考提示词，然后点击"AI生成变体"</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ===================== -->
                <!-- PDF 文件上传区域 -->
                <!-- ===================== -->
                <div class="mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-xl font-semibold text-gray-800 flex items-center">
                            <iconify-icon icon="carbon:document-multiple-01" class="mr-2 text-blue-500" width="24"></iconify-icon>
                            文件上传 (可多选)
                        </h2>
                        <label id="batchModeToggleWrapper" class="hidden flex items-center space-x-2 text-sm text-gray-600">
                            <span class="select-none">批量模式</span>
                            <input type="checkbox" id="batchModeToggle" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                        </label>
                    </div>
                    <!-- 拖拽区域与浏览按钮 -->
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center mb-4" id="dropZone">
                        <input type="file" id="pdfFileInput" accept=".pdf,.md,.txt,.docx,.pptx,.html,.htm,.epub,.yaml,.yml,.zip" class="hidden" multiple>
                        <input type="file" id="folderInput" class="hidden" webkitdirectory mozdirectory multiple>
                        <div class="mx-auto mb-4 w-16 h-16 flex items-center justify-center rounded-full bg-blue-50">
                            <iconify-icon icon="carbon:upload" class="text-blue-500" width="32"></iconify-icon>
                        </div>
                        <h3 class="text-lg font-medium text-gray-800 mb-1">拖放 PDF / MD / TXT / DOCX / PPTX / HTML / EPUB / YAML 文件到这里</h3>
                        <p class="text-sm text-gray-500 mb-4">或者</p>
                        <div class="flex flex-wrap justify-center gap-3">
                            <button id="browseFilesBtn" class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                                浏览文件
                            </button>
                            <button id="browseFolderBtn" class="px-6 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-all focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                                上传文件夹
                            </button>
                            <button id="githubImportBtn" class="px-6 py-2 bg-slate-500 text-white rounded-lg hover:bg-slate-600 transition-all focus:outline-none focus:ring-2 focus:ring-slate-500 focus:ring-offset-2">
                                GitHub 导入
                            </button>
                        </div>
                    </div>
                    <!-- 已选文件列表显示区域 -->
                    <div id="fileListContainer" class="max-h-60 overflow-y-auto border-2 border-dashed border-gray-300 rounded-lg p-3 bg-gray-50 hidden">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-medium text-gray-700">已选文件:</span>
                            <button id="clearFilesBtn" class="text-sm text-red-500 hover:text-red-700">清空列表</button>
                        </div>
                        <div id="fileFormatFilters" class="flex flex-wrap gap-2 mb-3 text-xs text-gray-600"></div>
                        <div id="fileList">
                            <!-- File items will be added here by JavaScript -->
                        </div>
                    </div>

                    <div id="batchModeConfig" class="hidden mt-4 border border-blue-200 bg-blue-50/60 rounded-lg">
                        <div class="flex items-center justify-between px-4 py-3 border-b border-blue-100">
                            <span class="text-sm font-semibold text-blue-700">批量导出配置</span>
                            <button type="button" id="batchModeConfigToggle" class="text-xs text-blue-600 hover:text-blue-700 flex items-center space-x-1">
                                <iconify-icon id="batchModeConfigToggleIcon" icon="carbon:chevron-down" width="14"></iconify-icon>
                                <span id="batchModeConfigToggleLabel">展开设置</span>
                            </button>
                        </div>
                        <div id="batchModeConfigBody" class="hidden px-4 py-4">
                            <div class="flex flex-col md:flex-row md:items-start md:space-x-6 space-y-4 md:space-y-0">
                                <div class="flex-1 min-w-0">
                                    <label for="batchModeTemplate" class="block text-sm font-medium text-gray-700 mb-1">命名模板</label>
                                    <input type="text" id="batchModeTemplate" class="w-full rounded-md border border-blue-200 bg-white px-3 py-2 text-sm text-gray-800 focus:border-blue-400 focus:ring-2 focus:ring-blue-200" placeholder="例如 {original_name}_{output_language}_{processing_time:YYYYMMDD-HHmmss}.{original_type}">
                                    <p class="text-xs text-gray-600 mt-2 leading-4">
                                        可用变量：<span class="font-mono text-[11px]">{original_name}</span>、<span class="font-mono text-[11px]">{original_type}</span>、<span class="font-mono text-[11px]">{output_language}</span>、<span class="font-mono text-[11px]">{processing_time}</span> (支持 <span class="font-mono text-[11px]">{processing_time:YYYYMMDD-HHmmss}</span> 等格式)。
                                    </p>
                                </div>
                                <div class="md:w-64">
                                    <span class="block text-sm font-medium text-gray-700 mb-1">批量导出格式</span>
                                    <div class="flex flex-wrap items-center gap-3 text-sm text-gray-700">
                                        <label class="inline-flex items-center space-x-2">
                                            <input type="checkbox" data-batch-format="original" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" checked>
                                            <span>原格式</span>
                                        </label>
                                        <label class="inline-flex items-center space-x-2">
                                            <input type="checkbox" data-batch-format="markdown" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" checked>
                                            <span>Markdown</span>
                                        </label>
                                        <label class="inline-flex items-center space-x-2">
                                            <input type="checkbox" data-batch-format="html" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span>HTML</span>
                                        </label>
                                        <label class="inline-flex items-center space-x-2">
                                            <input type="checkbox" data-batch-format="docx" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span>DOCX</span>
                                        </label>
                                        <span class="hidden w-px h-4 bg-blue-100 md:block"></span>
                                        <label class="inline-flex items-center space-x-2">
                                            <input type="checkbox" id="batchModeZipToggle" data-batch-zip class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span>导出时打包为 ZIP</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 验证状态提示区域 -->
                <div id="validationAlert" class="hidden mt-6 mb-4 p-3.5 rounded-lg border transition-all shadow-sm">
                    <div class="flex items-start gap-3">
                        <iconify-icon id="validationIcon" icon="carbon:warning" class="flex-shrink-0 mt-0.5" width="18"></iconify-icon>
                        <div class="flex-1 min-w-0">
                            <div class="flex items-center justify-between mb-1">
                                <h3 id="validationTitle" class="font-medium text-sm"></h3>
                                <button id="validationRefreshBtn" class="text-xs opacity-60 hover:opacity-100 transition-opacity" title="重新检查">
                                    <iconify-icon icon="carbon:renew" width="16"></iconify-icon>
                                </button>
                            </div>
                            <p id="validationMessage" class="text-sm opacity-90"></p>
                            <div id="validationActions" class="mt-2.5 flex flex-wrap gap-2"></div>
                        </div>
                    </div>
                </div>

                <!-- 处理按钮 -->
                <div class="flex justify-center mt-8">
                    <button id="processBtn" class="px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center">
                        <iconify-icon icon="carbon:play" class="mr-2" width="20"></iconify-icon>
                        <span>开始处理</span>
                    </button>
                </div>
            </div>

            <!-- ===================== -->
            <!-- 进度与结果区域 -->
            <!-- ===================== -->
            <!-- 处理进度显示区 -->
            <div id="progressSection" class="bg-white rounded-xl shadow-sm p-6 mb-8 hidden">
                <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                    <iconify-icon icon="carbon:progress-bar" class="mr-2 text-blue-500" width="24"></iconify-icon>
                    处理进度
                </h2>
                <!-- 批处理总体进度文本 -->
                <div class="mb-2">
                    <span id="batchProgressText" class="text-sm font-medium text-gray-700"></span>
                </div>
                <!-- 并发任务进度文本 -->
                 <div class="mb-2">
                    <span id="concurrentProgressText" class="text-sm font-medium text-gray-600"></span>
                </div>
                <!-- 单个文件/步骤进度条 -->
                <div class="mb-4">
                    <div class="flex justify-between mb-1">
                        <span id="progressStep" class="text-sm font-medium text-gray-700">等待开始...</span>
                        <span id="progressPercentage" class="text-sm font-medium text-gray-700">0%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                        <div id="progressBar" class="bg-blue-600 h-2.5 rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>
                </div>
                <!-- 处理日志显示区 -->
                <div id="progressLog" class="bg-gray-50 rounded-lg p-4 h-40 overflow-auto text-sm text-gray-600 font-mono"></div>
            </div>

            <!-- 处理结果显示与下载区 -->
            <div id="resultsSection" class="bg-white rounded-xl shadow-sm p-6 mb-8 hidden">
                <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                    <iconify-icon icon="carbon:document-download" class="mr-2 text-blue-500" width="24"></iconify-icon>
                    处理完成
                </h2>
                <p class="text-gray-600 mb-4">所有文件处理完成。您可以下载包含所有结果的 ZIP 文件。</p>
                <!-- 结果统计摘要 -->
                <div id="resultsSummary" class="mb-4 text-sm text-gray-700">
                    <!-- Summary will be added here -->
                </div>
                <!-- 下载全部结果按钮 -->
                <button id="downloadAllBtn" class="mt-3 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 flex items-center justify-center w-full md:w-auto">
                    <iconify-icon icon="carbon:download" class="mr-2" width="20"></iconify-icon>
                    <span>下载全部结果 (ZIP)</span>
                </button>
            </div>
            <!-- Moved disclaimer text inside main -->
            <p class="text-center text-gray-500 text-xs max-w-xl mx-auto mt-0 mb-4">注意：AI 模型翻译结果仅供参考，最终内容请以原文为准</p>
        </main>

        <!-- ===================== -->
        <!-- 页脚 -->
        <!-- ===================== -->
        <footer class="text-center text-gray-500 text-sm mt-12">
            <!-- 版权或链接信息 -->
            <p class="mb-2">
                <span id="showCopyrightModal" class="text-blue-500 hover:text-blue-700 transition-colors cursor-pointer select-none">
                    <iconify-icon icon="carbon:logo-github" class="mr-1" inline></iconify-icon>
                    Paper Burner X 丨 基于 Paper Burner
                </span>
            </p>
        </footer>
    </div>

    <!-- ===================== -->
    <!-- 通知系统浮层 -->
    <!-- (用于显示操作反馈，如成功、错误、警告信息) -->
    <!-- ===================== -->
    <div id="notification-container" class="fixed top-4 right-4 z-50 flex flex-col items-end space-y-2 pointer-events-none max-w-lg"></div>

    <!-- ===================== -->
    <!-- 脚本引入区（顺序不能乱） -->
    <!-- ===================== -->
    <script src="https://unpkg.com/iconify-icon@1.0.7/dist/iconify-icon.min.js"></script>
    <script src="js/api/api.js"></script>
    <script src="js/storage/storage.js"></script>
    <script src="https://gcore.jsdelivr.net/npm/mammoth@1.4.21/mammoth.browser.min.js"></script>
    <script src="https://gcore.jsdelivr.net/npm/turndown@7.1.2/dist/turndown.min.js"></script>
    <script src="js/ui/ui-helpers.js"></script>
    <script src="js/ui/ui-notifications.js"></script>
    <script src="js/ui/ui-model-search.js"></script>
    <script src="js/ui/ui-model-panels.js"></script>
    <script src="js/ui/ui-processing.js"></script>
    <script src="js/ui/ui-key-manager-modal.js"></script>
    <script src="js/ui/key-manager-ui.js"></script>
    <!-- Embedding 向量搜索模块 -->
    <script src="js/chatbot/agents/embedding-client.js"></script>
    <script src="js/chatbot/agents/vector-store.js"></script>
    <script src="js/chatbot/agents/semantic-vector-search.js"></script>
    <script src="js/ui/ui.js"></script>
    <script src="js/ui/glossary-ui.js"></script>
    <!-- 子块分割器（支持中英文标点分割），用于高亮与批注的精确定位 -->
    <script src="js/processing/sub_block_segmenter.js"></script>
    <!-- 修改为普通脚本标签，不使用模块 -->
    <script src="js/process/index.js"></script>
    <script src="js/process/prompt-pool-api.js"></script>
    <script src="js/process/prompt-pool.js"></script>
    <script src="js/ui/prompt-pool-ui.js"></script>
    <script src="js/api/model-detector.js"></script>
    <script src="js/app.js"></script>
    <script src="js/processing/markdown_processor_enhanced.js"></script>
    <script src="js/processing/markdown_text_fix.js"></script>
    <script src="js/processing/markdown_processor.js"></script>
    <script src="js/history/exporter/history_exporter_docx.js"></script>
    <script src="js/history/history_exporter.js"></script>
    <script src="js/history/history.js"></script>
    <script src="https://gcore.jsdelivr.net/npm/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js"></script>



    <!-- ===================== -->
    <!-- 历史记录浮动按钮与面板 -->
    <!-- ===================== -->
    <!-- 浮动按钮，点击显示历史记录面板 -->
    <div id="history-fab" style="position:fixed;bottom:32px;right:32px;z-index:9999;">
      <button id="showHistoryBtn" class="bg-blue-600 text-white rounded-full shadow-lg p-4 hover:bg-blue-700 transition-all focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1">
        <iconify-icon icon="carbon:time" width="28"></iconify-icon>
      </button>
    </div>
    <!-- 历史记录面板 (模态框) -->
    <div id="historyPanel" class="fixed inset-0 z-50 bg-black/30 backdrop-blur-sm flex items-center justify-center hidden p-4">
      <div class="bg-white rounded-xl shadow-xl p-4 md:p-6 w-[92vw] md:w-[90vw] max-w-6xl max-h-[90vh] flex flex-col overflow-hidden">
        <div class="flex justify-between items-center pb-3 mb-3 border-b border-gray-200">
          <span class="font-semibold text-lg text-gray-700">历史记录</span>
          <button id="closeHistoryPanel" class="text-gray-400 hover:text-red-500 transition-colors"><iconify-icon icon="carbon:close" width="24"></iconify-icon></button>
        </div>
        <div class="flex flex-1 min-h-0 gap-4">
          <aside class="hidden md:flex w-60 shrink-0 border border-gray-100 rounded-lg bg-gray-50/80 p-3 flex-col" id="historySidebar">
            <div class="flex items-center justify-between text-xs font-semibold text-gray-600 uppercase tracking-wide">
              <span>历史文件夹</span>
              <button id="historyAddFolderBtn" class="text-blue-500 hover:text-blue-600 transition-colors flex items-center gap-1 text-xs font-medium" type="button">
                <iconify-icon icon="carbon:add" width="16"></iconify-icon>
                新建
              </button>
            </div>
            <div class="mt-3 flex-1 overflow-y-auto" id="historyFolderList" aria-label="历史文件夹列表"></div>
          </aside>
          <div class="flex-1 flex flex-col min-h-0">
            <div class="pb-2 md:hidden">
              <div class="flex items-center gap-2">
                <div class="flex-1">
                  <label for="historyFolderSelectMobile" class="sr-only">筛选文件夹</label>
                  <select id="historyFolderSelectMobile" class="w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm focus:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-200">
                    <option value="all">全部记录</option>
                  </select>
                </div>
                <button id="historyAddFolderBtnMobile" class="text-blue-600 hover:text-blue-700 transition-colors flex items-center gap-1 text-sm font-medium shrink-0" type="button" aria-label="新建文件夹" title="新建文件夹">
                  <iconify-icon icon="carbon:add" width="18"></iconify-icon>
                  <span class="hidden sm:inline">新建</span>
                </button>
                <button id="historyRenameFolderBtnMobile" class="text-gray-600 hover:text-blue-700 transition-colors flex items-center gap-1 text-sm font-medium shrink-0" type="button" aria-label="重命名文件夹" title="重命名当前文件夹">
                  <iconify-icon icon="carbon:edit" width="18"></iconify-icon>
                  <span class="hidden sm:inline">重命名</span>
                </button>
                <button id="historyDeleteFolderBtnMobile" class="text-gray-600 hover:text-red-600 transition-colors flex items-center gap-1 text-sm font-medium shrink-0" type="button" aria-label="删除文件夹" title="删除当前文件夹">
                  <iconify-icon icon="carbon:trash-can" width="18"></iconify-icon>
                  <span class="hidden sm:inline">删除</span>
                </button>
              </div>
            </div>
            <div class="pb-3">
              <label for="historySearchInput" class="sr-only">搜索历史记录</label>
              <div class="relative">
                <iconify-icon icon="carbon:search" class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" width="18"></iconify-icon>
                <input id="historySearchInput" type="search" placeholder="搜索历史文件、OCR、译文或路径" class="w-full rounded-lg border border-gray-200 bg-white pl-9 pr-3 py-2 text-sm focus:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-200" autocomplete="off">
              </div>
            </div>
            <div id="historyList" class="flex-1 overflow-y-auto space-y-2 pr-1" aria-live="polite"></div>
          </div>
        </div>
        <button id="clearHistoryBtn" class="mt-4 w-full bg-red-50 hover:bg-red-100 text-red-600 border border-red-200 rounded-lg py-2.5 px-4 transition-colors flex items-center justify-center text-sm font-medium">
            <iconify-icon icon="carbon:trash-can" class="mr-2" width="18"></iconify-icon>
            清空历史
        </button>
      </div>
    </div>
    <!-- 历史记录详情弹窗 (已废弃，详情在新页面打开) -->
    <div id="historyDetailModal" class="fixed inset-0 z-[99999] bg-black bg-opacity-30 flex items-center justify-center hidden">
      <div class="bg-white rounded-xl border-2 border-dashed border-gray-300 p-6 w-[90vw] max-w-2xl max-h-[90vh] overflow-y-auto relative">
        <button id="closeHistoryDetail" class="absolute top-2 right-2 text-gray-400 hover:text-red-500"><iconify-icon icon="carbon:close" width="20"></iconify-icon></button>
        <div id="historyDetailContent"></div>
      </div>
    </div>

    <!-- 历史记录清空三步确认弹窗 -->
    <div id="historyClearConfirmModal" class="fixed inset-0 z-[100000] bg-black/50 backdrop-blur-sm hidden items-center justify-center px-4">
      <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden">
        <div class="px-6 py-4 border-b border-gray-100 flex items-center justify-between">
          <div class="flex items-center space-x-3">
            <span class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-red-100 text-red-600 font-semibold">!</span>
            <div>
              <h3 class="text-lg font-semibold text-gray-800">清空历史记录</h3>
              <p class="text-xs text-gray-500">清除操作不可恢复，请谨慎确认</p>
            </div>
          </div>
          <button id="historyClearCloseBtn" class="text-gray-400 hover:text-red-500 transition-colors">
            <iconify-icon icon="carbon:close" width="22"></iconify-icon>
          </button>
        </div>

        <div class="px-6 py-5 space-y-2">
          <div id="historyClearStep1" class="space-y-3" aria-hidden="false">
            <p id="historyClearStep1Message" class="text-sm text-gray-700 leading-relaxed">
              即将永久删除所有历史记录（包括所有批次、译文、文件夹分配）。请确认是否继续。
            </p>
            <div class="flex justify-end space-x-3">
              <button id="historyClearCancelBtn" class="px-3 py-2 text-sm rounded-md border border-gray-200 text-gray-500 hover:bg-gray-100">取消</button>
              <button id="historyClearStep1Next" class="px-4 py-2 text-sm rounded-md bg-red-500 text-white hover:bg-red-600">继续</button>
            </div>
          </div>

          <div id="historyClearStep2" class="space-y-2" hidden aria-hidden="true">
            <p class="text-sm text-gray-700 leading-relaxed -mt-1">
              请在下方输入 <span class="px-2 py-0.5 bg-red-50 text-red-600 rounded-md font-semibold">确定删除</span> 以确认操作。
            </p>
            <label class="sr-only" for="historyClearPhraseInput">输入 “确定删除” 以继续</label>
            <input id="historyClearPhraseInput" type="text" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-300 focus:border-red-400" placeholder="请输入 确定删除" autocomplete="off" aria-describedby="historyClearPhraseHint">
            <p id="historyClearPhraseHint" class="text-xs text-gray-500">必须准确输入 “确定删除” 才能继续。</p>
            <div class="flex justify-between items-center">
              <button id="historyClearStep2Back" class="text-sm text-gray-500 hover:text-gray-700">返回</button>
              <button id="historyClearStep2Next" class="px-4 py-2 text-sm rounded-md bg-red-500 text-white opacity-60 cursor-not-allowed" disabled>确认短语</button>
            </div>
          </div>

          <div id="historyClearStep3" class="space-y-3" hidden aria-hidden="true">
            <div class="bg-red-50 border border-red-100 rounded-lg p-4 text-sm text-red-700">
              <p class="font-semibold">最终确认：</p>
              <p id="historyClearFinalMessage" class="mt-1 leading-relaxed">历史记录一旦清空，将无法恢复。请确保已备份需要的数据。</p>
            </div>
            <div class="flex justify-between items-center">
              <button id="historyClearStep3Back" class="text-sm text-gray-500 hover:text-gray-700">返回</button>
              <button id="historyClearExecute" class="px-4 py-2 text-sm rounded-md bg-red-600 text-white hover:bg-red-700">永久删除</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ===================== -->
    <!-- 模型搜索弹窗 -->
    <!-- ===================== -->
    <div id="modelSearchOverlay" class="hidden fixed inset-0 z-[60] bg-black bg-opacity-40 backdrop-blur-sm flex items-center justify-center px-3 py-6 sm:px-4 sm:py-8 overflow-y-auto">
      <div class="bg-white rounded-2xl shadow-2xl w-full sm:max-w-2xl h-[88vh] sm:h-auto sm:max-h-[82vh] flex flex-col overflow-hidden">
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between px-4 sm:px-5 py-3 border-b gap-2">
          <h3 id="modelSearchTitle" class="text-base sm:text-lg font-semibold text-gray-800">选择模型</h3>
          <button id="modelSearchCloseBtn" class="self-end sm:self-auto text-gray-400 hover:text-red-500 transition-colors">
            <iconify-icon icon="carbon:close" width="20"></iconify-icon>
          </button>
        </div>
        <div class="px-4 sm:px-5 py-4 grid sm:flex sm:flex-col grid-rows-[3fr_7fr] gap-3 sm:gap-4 flex-1 min-h-0">
          <div class="min-h-0">
            <input id="modelSearchInput" type="search" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors" placeholder="搜索模型..." autocomplete="off" />
          </div>
          <div class="min-h-0 overflow-hidden">
            <div id="modelSearchList" class="h-full overflow-y-auto space-y-2 pr-1 sm:max-h-[55vh]">
              <!-- 动态填充模型列表 -->
            </div>
            <div id="modelSearchEmpty" class="hidden text-sm text-gray-500 text-center py-6 border border-dashed border-gray-200 rounded-lg mt-3">暂无可选项</div>
          </div>
        </div>
      </div>
    </div>

    <!-- 模型与Key管理弹窗 -->
    <!-- ===================== -->
    <div id="modelKeyManagerModal" class="fixed inset-0 z-50 bg-black bg-opacity-30 flex items-center justify-center hidden p-4">
      <div class="bg-white rounded-xl shadow-2xl w-full md:w-[95vw] max-w-5xl max-h-[90vh] flex flex-col overflow-hidden">
        <!-- 弹窗头部 -->
        <div class="flex justify-between items-center p-4 border-b sticky top-0 bg-white z-10">
          <span class="font-bold text-lg">模型与 Key 管理</span>
          <button id="closeModelKeyManager" class="text-gray-400 hover:text-red-500"><iconify-icon icon="carbon:close" width="20"></iconify-icon></button>
        </div>
        <!-- 主体内容区 - 左右布局 -->
        <div class="flex flex-1 overflow-hidden flex-col md:flex-row">
          <!-- 左侧模型/源站点列表 -->
          <div id="modelListColumn" class="w-full md:w-1/4 md:min-w-[220px] md:max-w-[260px] bg-gray-50 md:border-r border-b md:border-b-0 overflow-y-auto p-3 space-y-1 max-h-[40vh] md:max-h-none">
            <!-- 模型/源站点列表将由 JS 动态填充 -->
          </div>
          <!-- 右侧配置项与Key池管理 -->
          <div class="flex-1 p-4 overflow-y-auto space-y-4">
            <!-- 当前选中模型/源站点的配置项 -->
            <div id="modelConfigColumn" class="mb-4">
              <!-- 配置项将由 JS 动态填充 -->
            </div>
            <!-- API Key 管理界面 (由 key-manager-ui.js 渲染) -->
            <div id="keyManagerColumn" class="border-t pt-4">
              <!-- KeyManagerUI 实例将渲染到这里 -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ===================== -->
    <!-- 版权声明浮动卡片 -->
    <!-- ===================== -->
    <div id="copyrightModal" class="fixed inset-0 z-50 bg-black bg-opacity-30 flex items-center justify-center hidden px-4 py-8">
      <div class="copyright-card-ani p-6 md:p-10 w-full max-w-6xl relative max-h-[90vh] flex flex-col">
        <button id="closeCopyrightModal" class="absolute top-4 right-4 text-gray-400 hover:text-red-500 transition-colors z-10">
            <iconify-icon icon="carbon:close" width="24"></iconify-icon>
        </button>
        <div class="text-center mb-5 md:mb-6">
          <h2 class="text-2xl md:text-3xl font-extrabold tracking-tight mb-2">Paper Burner X 功能概览</h2>
        </div>
        <div class="text-gray-700 space-y-4 md:space-y-5 text-sm md:text-base font-normal overflow-y-auto pr-3 flex-1">
          <p class="leading-relaxed text-left text-sm md:text-base text-gray-700 font-normal">
            Paper Burner X 专注于浏览器端的一站式文献处理，整合 OCR、翻译、术语表、阅读、批注与 AI 分析能力，确保在本地即可完成从原文到知识沉淀的流程。
          </p>
          <div>
            <h3 class="text-base md:text-lg font-bold text-blue-700 mb-3 md:mb-4 flex items-center">
              <iconify-icon icon="carbon:list-checked" class="mr-2 text-blue-500" width="20"></iconify-icon>
              核心能力亮点：
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4">
              <article class="feature-card-modern text-left">
                <div class="feature-card-inner">
                  <div class="feature-icon-ring text-orange-500">
                    <iconify-icon icon="carbon:flash" width="22"></iconify-icon>
                  </div>
                  <div>
                    <h4 class="text-base md:text-lg font-semibold text-gray-800">极速并发翻译</h4>
                    <ul class="mt-1.5 text-xs md:text-sm text-gray-600 leading-relaxed space-y-1">
                      <li>多文件并发 + 自定义并发数，长篇论文亦能快速出译文。</li>
                      <li>提示词池健康监测，配合 Key 轮转保障稳定产出。</li>
                    </ul>
                    <div class="feature-meta">
                      <span class="bg-orange-100/80 text-orange-600">多文件</span>
                      <span class="bg-orange-50 text-orange-500 border border-orange-200/70">提示词池</span>
                    </div>
                  </div>
                </div>
              </article>
              <article class="feature-card-modern text-left">
                <div class="feature-card-inner">
                  <div class="feature-icon-ring text-blue-600">
                    <iconify-icon icon="carbon:settings-adjust" width="22"></iconify-icon>
                  </div>
                  <div>
                    <h4 class="text-base md:text-lg font-semibold text-gray-800">灵活配置中心</h4>
                    <ul class="mt-1.5 text-xs md:text-sm text-gray-600 leading-relaxed space-y-1">
                      <li>Base URL、模型自动检测、多 Key 轮询统一在一处配置。</li>
                      <li>术语表、提示词池与预设 prompt 联动，满足客制化翻译。</li>
                    </ul>
                    <div class="feature-meta">
                      <span class="bg-blue-100/80 text-blue-600">术语表</span>
                      <span class="bg-blue-50 text-blue-500 border border-blue-200/70">多源 Key</span>
                    </div>
                  </div>
                </div>
              </article>
              <article class="feature-card-modern text-left">
                <div class="feature-card-inner">
                  <div class="feature-icon-ring text-indigo-500">
                    <iconify-icon icon="carbon:notebook" width="22"></iconify-icon>
                  </div>
                  <div>
                    <h4 class="text-base md:text-lg font-semibold text-gray-800">沉浸式阅读体验</h4>
                    <ul class="mt-1.5 text-xs md:text-sm text-gray-600 leading-relaxed space-y-1">
                      <li>历史记录、原译对照、智能对齐与 TOC 导航协同校对。</li>
                      <li>沉浸模式 + 多彩标注，让重点整理更专注。</li>
                    </ul>
                    <div class="feature-meta">
                      <span class="bg-indigo-100/80 text-indigo-600">历史记录</span>
                      <span class="bg-indigo-50 text-indigo-500 border border-indigo-200/70">沉浸模式</span>
                    </div>
                  </div>
                </div>
              </article>
              <article class="feature-card-modern text-left">
                <div class="feature-card-inner">
                  <div class="feature-icon-ring text-purple-600">
                    <iconify-icon icon="carbon:ai-status" width="22"></iconify-icon>
                  </div>
                  <div>
                    <h4 class="text-base md:text-lg font-semibold text-gray-800">智能分析与导出</h4>
                    <ul class="mt-1.5 text-xs md:text-sm text-gray-600 leading-relaxed space-y-1">
                      <li>内置聊天助手与快捷指令，支持深度问答、流式输出。</li>
                      <li>思维导图、流程图与 HTML/PDF/DOCX/MD 多格式导出即用。</li>
                    </ul>
                    <div class="feature-meta">
                      <span class="bg-purple-100/80 text-purple-600">LLM 助手</span>
                      <span class="bg-purple-50 text-purple-500 border border-purple-200/70">多格式导出</span>
                    </div>
                  </div>
                </div>
              </article>
            </div>
          </div>
          <div>
            <h3 class="text-base md:text-lg font-bold text-blue-700 mb-2 flex items-center">
              <iconify-icon icon="carbon:road" class="mr-2 text-blue-500" width="20"></iconify-icon>
              近期路线：
            </h3>
            <ul class="list-disc pl-5 text-sm md:text-base text-gray-600 space-y-2">
              <li>拓展更多 OCR 引擎与结构化解析，增强复杂出版物的还原能力。</li>
              <li>强化术语表协同、批注数据同步与团队共享机制。</li>
              <li>优化界面布局，探索多窗口沉浸式工作流与更多可视化能力。</li>
            </ul>
          </div>
          <div class="border-t-2 border-dashed border-blue-200 pt-5 mt-5 text-center space-y-3">
            <p class="text-sm md:text-base text-gray-600 font-normal">探索本分支的更多细节或贡献您的智慧：</p>
            <a href="https://github.com/Feather-2/paper-burner" target="_blank" class="main-btn inline-flex items-center justify-center px-7 py-3 text-sm md:text-base font-bold shadow-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
              <iconify-icon icon="carbon:logo-github" class="mr-2" width="20"></iconify-icon>
              访问新分支 (Feather-2/paper-burner)
            </a>
            <p class="text-xs text-gray-400 font-normal pt-1">
              您的每一个建议对我们都至关重要！欢迎前往新分支的 <a href="https://github.com/Feather-2/paper-burner/issues" target="_blank" class="text-blue-600 hover:text-blue-700 underline font-semibold">Issue 区</a> 分享您的想法或参与讨论。
            </p>
            <p class="text-xs text-gray-400 italic">
              致敬 <a href="https://github.com/baoyudu/paper-burner" target="_blank" class="text-blue-500 hover:text-blue-600 underline">Paper Burner</a> 开源项目，Paper Burner X 在社区基础上持续扩展与迭代。
            </p>
          </div>
        </div>
      </div>
    </div>

    <script>
      // 一闪而过的提示文字淡入淡出动画 (用于"配置模型与Key管理"提示)
      window.addEventListener('DOMContentLoaded', function() {
        var tip = document.getElementById('flashConfigTip');
        if (tip) {
          tip.classList.add('show'); // 淡入
          setTimeout(function() {
            tip.classList.remove('show');
            tip.classList.add('hide'); // 淡出
          }, 1200); // 持续显示1.2秒
          setTimeout(function() {
            tip.style.display = 'none'; // 动画结束后隐藏元素
          }, 1800); // 总共1.8秒后隐藏
        }
      });

      // 版权声明弹窗逻辑
      (function() {
        var modal = document.getElementById('copyrightModal');
        var showBtn = document.getElementById('showCopyrightModal');
        var closeBtn = document.getElementById('closeCopyrightModal');
        var alreadyShown = localStorage.getItem('paperBurnerBranchInfoShown');

        function openModal() {
          if (modal) modal.classList.remove('hidden');
        }

        function closeModal() {
          if (modal) modal.classList.add('hidden');
        }

        if (showBtn) {
          showBtn.addEventListener('click', openModal);
        }
        if (closeBtn) {
          closeBtn.addEventListener('click', function() {
            closeModal();
            // 确保用户手动关闭后，标记为已显示，避免下次自动弹出
            localStorage.setItem('paperBurnerBranchInfoShown', 'true');
          });
        }
        // 点击遮罩关闭
        if (modal) {
          modal.addEventListener('click', function(e) {
            if (e.target === modal) {
              closeModal();
              localStorage.setItem('paperBurnerBranchInfoShown', 'true');
            }
          });
        }

        // 首次访问自动展开"关于本分支"卡片 (如果 Landing Page 未显示)
        // var landingPageIsActive = !localStorage.getItem('paperBurnerLandingPageShown'); // This logic is no longer needed here
        // if (!alreadyShown && modal && !landingPageIsActive) { // This logic is no longer needed here
        //   openModal();
        // }
      })();

      // Landing Page Logic Removed - main app is now shown by default // This line and related block will be removed by the next instruction.
    </script>
</body>
</html>
